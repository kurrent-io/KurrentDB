syntax = "proto3";

package kurrentdb.protocol.v2.custom_indexes;

option csharp_namespace = "KurrentDB.Protocol.V2.CustomIndexes";

import "google/api/annotations.proto";

enum KeyType {
  KEY_TYPE_UNSPECIFIED = 0;
  KEY_TYPE_STRING = 1;
  KEY_TYPE_NUMBER = 2;
  KEY_TYPE_INT_16 = 3;
  KEY_TYPE_INT_32 = 4;
  KEY_TYPE_INT_64 = 5;
  KEY_TYPE_UNSIGNED_INT_32 = 6;
  KEY_TYPE_UNSIGNED_INT_64 = 7;
}

service CustomIndexesService {
  //qq decide on route prefix
  rpc CreateCustomIndex(CreateCustomIndexRequest) returns (CreateCustomIndexResponse) {
    option (google.api.http) = {
      post: "/v2/custom-indexes/create/{name}",
      body: "*"
    };
  };

  rpc EnableCustomIndex(EnableCustomIndexRequest) returns (EnableCustomIndexResponse) {
    option (google.api.http) = {
      post: "/v2/custom-indexes/enable/{name}",
    };
  }

  rpc DisableCustomIndex(DisableCustomIndexRequest) returns (DisableCustomIndexResponse) {
    option (google.api.http) = {
      post: "/v2/custom-indexes/disable/{name}",
    };
  }

  rpc DeleteCustomIndex(DeleteCustomIndexRequest) returns (DeleteCustomIndexResponse) {
    option (google.api.http) = {
      delete: "/v2/custom-indexes/{name}"
    };
  }
}

message CreateCustomIndexRequest {
  string name = 1;
  string filter = 2;
  string partition_key_selector = 3;
  KeyType partition_key_type = 4;
  bool enabled = 5;
}

message CreateCustomIndexResponse {
}

message EnableCustomIndexRequest {
  string name = 1;
}

message EnableCustomIndexResponse {
}

message DisableCustomIndexRequest {
  string name = 1;
}

message DisableCustomIndexResponse {
}

message DeleteCustomIndexRequest {
  string name = 1;
}

message DeleteCustomIndexResponse {
}
